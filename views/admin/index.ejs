<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width,initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />
    <title>广告管理系统</title>
    <link rel="stylesheet" href="http://7wy4jj.com2.z0.glb.qiniucdn.com/styles/vendor-c85134c2.css">
    <link rel="stylesheet" href="http://7wy4jj.com2.z0.glb.qiniucdn.com/styles/admin-4f59659b.css">
</head>

<body>
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                </button>
                <a class="navbar-brand" href="/admin">广告管理后台</a>
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li id="nav-player" role="presentation" class="active"><a href="#whiteList" aria-controls="whiteList" role="tab" data-toggle="tab">白名单</a></li>
                    <li id="nav-money" role="presentation"><a href="#blackList" aria-controls="blackList" role="tab" data-toggle="tab">黑名单</a></li>
                    <li id="nav-announcement" role="presentation"><a href="#announcement" aria-controls="announcement" role="tab" data-toggle="tab">设置</a></li>
                </ul>
                <p class="navbar-text navbar-right"><a class="navbar-link login-out" href="/admin/login">退出</a></p>
            </div>
        </div>
    </div>
    <div class="container-fluid navbar-fixed-top page-nav">
        <div class="row">
            <div class="col-md-6 col-md-offset-3">
                <ul class="nav nav-pills">
                </ul>
            </div>
        </div>
    </div>

    <div class="container-fluid">
        <div class="tab-content">
            <div role="tabpanel" class="tab-pane active" aria-controls="whiteList" id="whiteList">
                <table class="table table-striped table-hover">
                    <tbody>
					<% if(whiteList) { %>
                        <% for(var i=0; i
                        <whiteList.length; i++) { %>
                            <tr>
                                <td>
                                    <%= whiteList[i] %>
                                </td>
								<td>
                                  <button id="del" class="btn btn-primary" value=  <%= whiteList[i] %> >删除</button>
                                </td>
                            </tr>
                            <% } %>
					 <% }else { %>
					 <td>白名单为空</td>
					  <% } %>
                    </tbody>
                </table>
            </div>
            <div role="tabpanel" class="tab-pane" aria-controls="blackList" id="blackList">
                <table class="table table-striped table-hover">
                    <tbody>
					<% if(blackList) { %>
                        <% for(var i=0; i
                        <blackList.length; i++) { %>
                            <tr>
                                <td>
                                    <%= blackList[i] %>
                                </td>
                            </tr>
                            <% } %>
					 <% } %>
                    </tbody>
                </table>
            </div>

            <div role="tabpanel" class="tab-pane" id="announcement">
                <div class="alert alert-danger alert-dismissible hidden" role="alert">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    网络错误，请稍候重试
                </div>
                <div class="form-group">
                    <textarea id="whiteList_edit" class=" form-control" rows="1"></textarea>
                </div>
                <button id="edit" class="btn btn-primary">添加白名单</button>
				<p></p><p></p>
				 <div class="form-group">
                    <textarea id="limit" rows="1" cols="3"></textarea>
                </div>
                <button id="blacklist_limit" class="btn btn-primary">设置黑名单长度</button>

            </div>
        </div>

    </div>
    <!-- 后续图表化 -->
    <div class="container show-data hidden">
        <input name="tagsinput" class="tagsinput" data-role="tagsinput" value="Clean, Fresh, Modern, Unique" />
        <canvas id="user-data" width="1128px" height="500"></canvas>
    </div>


    <script src="http://7wy4jj.com2.z0.glb.qiniucdn.com/scripts/admin-vendor-a6f2d356.js"></script>
	<script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <script type="text/javascript">
		$(function() {
			$("#edit").click(function(){
					var ip =$("#whiteList_edit").val()
					if(ip){
						$.get(
							"/ip/whiteList",
							{ip:ip},
							function(result){
								if(result){
									window.location.href="/admin"
								}else{
									alert("网络错误，请稍候重试")
								}
							}
						)
					}else{
						alert("请填写正确的ip")
					}
			});

			$("#del").click(function(){
					$.post(
						"/ip/whiteList",
						{ip:$(this).val()},
						function(result){
							if(result){
								window.location.href="/admin"
							}else{
							    alert("网络错误，请稍候重试")
							}
						}
					)
			});

		$("#blacklist_limit").click(function(){
					limit = $("#limit").val()
					if(!isNaN(limit)){
						$.post(
							"/ip",
							{limit:limit},
							function(result){
								if(result){
									//alert("success")
									 location.reload();
								}else{
									alert("网络错误，请稍候重试")
								}
							}
						)
					}else{
						alert("请填写正确的数字")
					}
			});
		});

    </script>
</body>

</html>